<%= render 'shared/errors', obj: @sku_list if @sku_list.present? %>
<%if @modal==true%><%= render 'product_modal'%><%end%>
<div align="center">

<div align="center">
  <%= will_paginate @list_products if @list_products %>
</div>

</div>
<div class="row">
  <% if current_user == @list.user %>
    <div class="col-sm-6 col-md-2">
      <div class="list_div">
        <%= @list.name %>
        <small id="sm01" class="js-private <%= "hidden" if !@list.private? %>" data-list="<%= @list.id %>" title="Click to change status" >
    	    private
        </small>
        <small id="sm01" class="js-visible <%= "hidden" if @list.private? %>" data-list="<%= @list.id %>" title="Click to change status">
    	    visible
        </small>
        <%= form_tag search_product_list_path(@list), method: :get do %>
          <div class="form-group">
            <div class="col-sm-10 col-sm-offset-1">
              <%= text_field_tag :skuid, params[:skuid], placeholder: "skuid", autofocus: true %>
            </div>
          </div>
          <div class="form-group">
            <div class="col-sm-2 col-sm-offset-4">
               <%= button_to "Search", search_product_list_path %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <%end%>
  <% if @list_products %>
    <% @list_products.each do |product| %>
      <div class="col-sm-6 col-md-2">
        <div class="list_div">
          <% if current_user == @list.user %>
            <%= link_to remove_product_list_path(@list, skuid: product.id), class: "btn btn-xs", 
            method: :put, data: {confirm: "Are you sure you want to delete this product from the list?"} do %>
            <span class="glyphicon glyphicon-remove"></span>
            <% end %>
          <% end %>
          <div>
            <img src="<%= product.images["main"]%>">
          </div>
          <div>
            <%= product.name %>
          </div>  
        </div>
      </div>
    <% end %>
  <%end%>
</div>

<script type="text/javascript">
  $(document).ready(function() {
    $('#productModal').modal('show');
    $(".js-visible, .js-private").on('click', function(){
      $.ajax({
        url:"/lists/"+$(this).data("list")+"/flop",
        success: function(data){
          $(".js-private").toggleClass("hidden");
          $(".js-visible").toggleClass("hidden");
        }
      });
    }); 
  });
</script>